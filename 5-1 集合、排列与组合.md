[[25暑期-CSPJ大纲题库#5.4 离散与组合数学✅]]
## 集合 2★

## 加法原理与乘法原理  2★

### 加法原理
完成一件事它可以有n类办法，在第一类办法中有$m_1$种不同的方法，在第二类办法中有$m_2$种不同的方法，以此类推，在第n类办法中有$m_n$种不同的方法，那么完成这件事共有$N = m_1+m_2+m_3+…+m_n$种不同方法。

加法原理分类计数法的要求：
- 每一类中的每一种方法都可以独立地完成此任务；
- 两类不同办法中的具体方法，互不相同(即分类不重)；
- 完成此任务的任何一种方法，都属于某一类(即分类不漏)。

### 乘法原理
做一件事，完成它需要分成$n$个步骤，做第一步有$m_1$种不同的方法，做第二步有$m_2$种不同的方法，以此类推，做第n步有$m_n$种不同的方法，那么完成这件事共有$N=m_1×m_2×m_3×…×m_n$。种不同的方法。

这里要注意区分两个原理：
要做一件事，完成它若是有$n$类办法，是分类问题，第一类中的方法都是独立的，因此用加法原理；
做一件事，需要分$n$个步骤，步与步之间是连续的，只有将分成的若干个互相联系的步骤，依次相继完成，这件事才算完成，因此用乘法原理。
这样完成一件事的分“类”和“步”是有本质区别的，因此也将两个原理区分开来。

乘法原理分步计数法的要求：任何一步的一种方法都不能完成此任务，必须且只须连续完成这$n$步才能完成此任务；各步计数相互独立；只要有一步中所采取的方法不同，则对应完成此事的方法也不同。


例如：  
（1）从甲城市到乙城市一共有几条路？5+3+7=15条【加法原理】  
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/c4998dd90564ec7ec146b330634a2712.png#pic_center)

（2）甲城市到丙城市有几条走法？3_2=6条【乘法原理】  
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/ec61f332d473083b480792daf2290fdb.png#pic_center)  
（3）甲城市到丙城市有几条走法？2+3+2_3条【乘法原理】&【加法原理】  
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/00df9ea6330006b0d6d3459daa7c12c4.png#pic_center)

## 阶乘

​**​阶乘​**​（Factorial）是数学中一个基本而重要的运算，主要用于排列组合、概率统计等领域。
对于一个​**​非负整数​**​ $n$，它的阶乘表示为 $n!$，定义为从 1 到 $n$ 所有正整数的乘积。具体来说：
$$n! = n \times (n-1) \times (n-2) \times \cdots \times 2 \times 1$$

### 阶乘的定义
阶乘的定义是递归的。
基本定义（递归出口）
- $0! = 1$（这是一个约定，为了数学上的统一性和便利性）
- $1! = 1$

递归定义
- $n! = n \times (n-1)!$（对于$n \geq 1$）

### 阶乘的例子
让我们计算几个小的正整数的阶乘：
- $2! = 2 \times 1 = 2$
- $3! = 3 \times 2 \times 1 = 6$
- $4! = 4 \times 3 \times 2 \times 1 = 24$
- $5! = 5 \times 4 \times 3 \times 2 \times 1 = 120$

可以看到，随着 $n$ 的增加，$n!$ 的值增长得非常快。

事实上，阶乘是增长最快的数列，也意味着其代表的时间复杂度最高。
![[Pasted image 20250520233548.png]]

### 阶乘的性质

**​快速增长​**​：
阶乘函数增长得非常迅速。例如：
$5!= 120$
$10! = 3,628,800$
$20! \approx 2.43 \times 10^{18}$
在处理阶乘运算时，应当注意可能的溢出。

**​与排列组合的关系​**​：
排列：从 $n$ 个不同物品中取出 $k$ 个进行排列的总数是 $\frac{n!}{(n-k)!}$。
组合：从 $n$ 个不同物品中取出 $k$ 个的组合数是 $\frac{n!}{k!(n-k)!}$。
**​与Gamma函数的关系​**​：
阶乘可以推广到非整数，通过Gamma函数 $\Gamma(n) = (n-1)!$ （对于正整数 $n$）。

### 计算阶乘的方法

**​迭代法​**​：
```python
def factorial(n):
	result = 1
	for i in range(1, n+1):
		result *= i
	return result

```
**​递归法​**​：
```python
def factorial(n):
	if n == 0:
		return 1
	else:
		return n * factorial(n-1)
```
  


## 排列与组合 4★
### 排列
#### 排列的定义
从n个不同元素中，任取m(m≤n)个元素，按照一定的顺序排成一列，叫作从n个不同元素中取出m个元素的一个排列（Permutation）。符号表示为$A_n^m$或者$P_n^m$。

从排列的意义可知，如果两个排列相同，
1. 这两个排列的==元素必须完全相同==；
2. 排列的===顺序必须完全相同===；

这就告诉了我们判断两个排列是否相同的方法。
#### 排列数公式★

从n个不同元素中取出$m(m≤n)$个元素的所有排列，可以用记号和公式表示为：$$ P_{n}^{m}= A_{n}^{m} = \frac{n!}{(n - m)!} $$
当m=n时，称为全排列，此时表示为$$ P_{n}^{n}= A_{n}^{n} = {n!}=n*(n-1)*…*2*1$$
### 组合
#### 组合的定义
从$n$个不同元素中，任取$m(m≤n)$个元素并成一组，叫作从$n$个不同元素中取出$m$个元素的一个组合（Combination）。

从组合的定义知，如果两个组合中的元素完全相同，===不管元素的顺序===如何，都是相同的组合；只有==当两个组合中的元素不完全相同==时，才是不同的组合。
#### 组合数公式★

$$ C_{n}^{m}= \frac{n!}{m!(n - m)!} = C_{n}^{n-m}$$
由公式可见组合具有对称性，可以用于简化计算。如$C_{12}^{8}= C_{12}^{4}$；
同时，可以推出$C_{n}^{0}= C_{n}^{m}=1$。
### 排列与组合的关系
$$A_{n}^{m}= C_{n}^{m}*A_{m}^{m}= C_{n}^{n-m} *A_{m}^{m}$$

### 排列与组合的判断★
排列与元素的顺序有关，而组合则与元素的顺序无关。

**判断练习**
(a)设集合$A={a,b,c,d,e}$，则集合 A 的含有 $3$ 个元素的子集有多少个? 

(b)某铁路线上有 $5$ 个车站，则这条铁路线上共需准备多少种车票? 

(c)$10$ 名同学分成人数相同的数学和英语两个学习小组，共有多少种分法? 

(d)$10$ 人聚会，见面后每两人之间要握手相互问候，共需握手多少次? 

(e)从 4 个风景点中选出 2 个游览,有多少种不同的方法？

(f)从 4 个风景点中选出 2 个，并确定这 2 个风景点的游览顺序，有多少种不同的方法?

答案：
bf排列，其他组合



### 应用
#### 1 特殊优先（分步讨论）★
特殊元素，优先处理；特殊位置，优先考虑；分步骤使用乘法原理实现。

例1
$6$人站成一排，求甲不在排头，乙不在排尾的排列数；

解：
先考虑排头，排尾，但这两个要求相互有影响，因而考虑分类（加法原理）。
第一类：乙在排头，甲一定不在排头，剩下5个人随便站，有$A(5,5)$种站法；
第二类：乙不在排头，当然也不能在排尾，有$4*4*A(4,4)$种站法；
加起来，一共$A(5,5)+4*4*A(4,4)$种站法。


例2 
从黄瓜、白菜、油菜、扁豆 4 种蔬菜品种中选出 3 种，分别种在不同土质的三块土地上，其中黄瓜必须种植，不同的种植方法共有多少种。

解：先选后排，分步实施。由题意，因为黄瓜必须选择，剩下3种选2种，不同的选法有 $C(2/3)$ 种；土地的不同的排法有 $A(3/3)$。分步计算，使用乘法原理，故不同的种植方法共有 $C(2/3)*A(3/3)=18$ 。


#### 2 捆绑法与插空法
2.1 捆绑法：在解决排列问题的时候，有些问题需要相邻元素在一起，这种把相邻元素看作一个整体，再与其他元素一起排列，同时注意捆绑元素的内部排列的方法叫捆绑法。

例1
$5$ 个男生 $3$ 个女生排成一排，$3$ 个女生要排在一起，有多少种不同的排法？

解：因为女生要排在一起，所以可以将 $3$ 个女生看成是一个人，与 $5$ 个男生作全排列，因此有 $A(6,6)$ 种排法；
再来排女生内部，$3$个女生内部也有 $A(3,3)$ 种排法；
根据乘法原理，共有 $A(3,3) * A(6,6) = 4320$ 种不同的排法。

例2
7个不同的球放到6个不同的盒子中，要求每个盒子至少放一个球，一共有多少种方法?

解答：根据题目要求，其中一个盒子必须放2个，其他每个盒子放1个球，所以从7个球中挑出2个球看成一个整体，则有$C(7,2)$，这个整体和剩下5个球放入6个盒子里，则有$A(6,6)$，方法总数是$C(7,2)*A(6,6)$。


2.2 插空法：在解决对于某几个元素要求不相邻的问题时，先将其他元素排好，再将指定的不相邻的元素插入已排好元素的间隙或两端位置，从而将问题解决的方法叫插空法。

例1
7 名学生站成一排，甲乙互不相邻，有多少不同排法？
解：甲、乙二人不相邻的排法一般应用“插空”法，所以甲、乙二人不相邻的排法总数
计算应为： $A(5,5)*A(2,6) =3600$ 种。

例2
某人射击8枪，命中4枪，恰好有三枪连续命中，有多少种不同的情况?

解析：因为连续命中的3枪与单独命中的1枪不能相邻，因而这是一个插空问题。其次，空枪之间没有顺序上的区别，不必计数。即在四发空枪之间形成的5个空中选出2个的排列，即$A(5,2)$。

例3
马路上有编号为1,2,3,…,10十个路灯，为节约用电又看清路面，可以把其中的3只灯关掉，但不能同时关掉相邻的两只或三只，在两端的灯也不能关掉的情况下，求满足条件的关灯方法共有多少种?

分析：即关掉的灯不能相邻，也不能在两端。又因为灯与灯之间没有区别，因而问题转化为插空问题，即在$7$盏亮着的灯形成的不包含两端的$6$个空中选出$3$个空放置熄灭的灯。一共$C(6,3)=20$种方法。


#### 3 排除法
先计算总体，再计算容易的情况，排除后剩下的就是要求的情况。也就是逆用加法原理。

例
从 13 人中任抽 5 人，正、副班长、团支部书记至少有一人在内的抽法有多少种？

解：13 人中任抽 5 人的方法 $C(5,13)$ 种，正副班长，团支部书记都不在内的抽法有$C(5,10)$种，所以正副班长，团支部书记至少有 1 人在内的抽法有 $C(5,13)-C(5,10)$ 种。


每份考卷都有一个8位二进制序列号。当且仅当一个序列号含有偶数个1时，它才是有效的。例如，00000000、01010011都是有效的序列号，而11111110不是。那么有效的序列号共有___个。

#### 4 隔板法（插板法）★
隔板法使用的前提是所有元素必须相同，然后需要把这些元素分成若干组，每组至少有一个元素的计数方法。

题型模板
 有$n$个相同元素，不同个$m$组，每组至少有一个元素，求共有多少种不同分组方法?
 
 解题思路
 将$n$个相同的元素排成一行，$n$个元素之间出现了$(n-1)$个空档，现在我们用$(m-1)$个“档板”插入$(n-1)$个空档中，就把$n$个元素隔成有序的$m$份，每个组依次按组序号分到对应位置的几个元素。这样不同的插入办法就对应着$n$个相同的元素分到$m$组的一种分法。
 这种借助于虚拟“档板”分配元素的方法称为插板法。计算方式是组合，即$C_{n-1}^{m-1}$。


例1
10个名额分配到8个班，每班至少1个名额，问有多少种不同的分配方法?

分析：把10个名额看成10个元素，在这10个元素之间形成的9个空中，选出7个位置放置档板，则每一种放置方式就相当于一种分配方式。因而共有$C_9^7=C_9^2=36$种。


## 容斥原理
在计数时，我们必须确保计数无一重复，无一遗漏，还要使重叠部分不被重复计算。

基本思想：
先不考虑重叠的情况，把包含于某内容中所有对象的数目先计算出来；
再把计数时重复计算的数目排斥出去，使得计算的结果既无遗漏又无重复，这种计数的方法称为容斥原理（Inclusion-Exclusion Principle）
### 基本形式
对于两个集合 A 和 B：
$$|A \cup B| = |A| + |B| - |A \cap B|$$
如果被计数的事物有3类：
$$|A∪B∪C| = |A+B+C| - |A∩B| - |B∩C| - |C∩A| + |A∩B∩C|$$

>  $|A|$ 表示集合 $A$ 的元素个数



### 应用场景

#### 1 计数问题​​


例1 求满足某些条件的整数个数。
在 1 到 100 的整数中，有多少个能被 2 或 3 整除？

解：
- 设 $A$ 为能被 2 整除的数，$|A| = \lfloor 100/2 \rfloor = 50$
- 设 $B$ 为能被 3 整除的数，$|B| = \lfloor 100/3 \rfloor \approx 33$
- $A \cap B$ 为能被 6 整除的数，$|A \cap B| = \lfloor 100/6 \rfloor \approx 16$。
- 根据容斥原理：

$$
|A \cup B| = 50 + 33 - 16 = 67
$$

因此，共有 $67$ 个满足条件的数。

例2
一次期末考试，某班有$15$人数学得满分，有$12$人语文得满分，并且有4人的语、数都是满分，那么这个班至少有一门得满分的同学有(     )人。
A.23 
B.21 
C.20 
D.22

答案A
由容斥原理可以得知，答案为$15+12-4=23$。


#### 2 错位排列问题

容斥原理通过系统性地处理重叠部分，使得复杂计数问题变得清晰可解。

概率计算​​：多个事件至少发生一件的概率；排列组合​​：如错位排列（Derangement）问题。





## 抽屉原理
想象一个场景，桌上有10个苹果，要把这10个苹果放到9个抽屉里，无论怎样放，我们会发现至少会有1个抽屉里面放不少于2个苹果。这一现象就是抽屉原理（Drawer Principle）。
#### 基本形式

简单形式：如果每个抽屉代表一个集合，每一个苹果就可以代表一个元素，假如有 $n+1$个元素放到 $n$ 个集合中去，其中必定有1个集合里至少有2个元素；
可以推出，如果有 $kn+1$个元素放入 $n$ 个集合中，将元素放入集合中之后，**至少**有1个集合中有 $k+1$ 个元素。

总结抽屉原理的推广形式：如果有 $n$ 个集合和 $m$个元素，将元素放入集合中之后，至少有1个集合中有 $\lceil \frac{n}{m} \rceil$ 个或更多元素。

n除以m的值向上取整。

抽屉原理有时也被称为鸽巢原理（Pigeonhole Principle）。

运用抽屉原理的核心是分析清楚问题中，**哪个是放入的物品**，**哪个是抽屉**。

#### 应用场景

例1：星座有 $12$ 个，那么任意 $37$ 个人中，至少有多少个人属于同一个星座？
答：$2$个
解：
这时将星座看成 $12$ 个抽屉，考虑最均匀分配的情况，$12*3 = 36$，每个抽屉$3$个元素，然后再考虑余数，多出1个人需要分配到某个星座，至少有一个星座的人数会变成$3+1=4$，结论是无论如何分配，至少有一个星座的人数不少于4个人。

也可以使用抽屉原理的推广形式计算：
$\text{最少重复人数} = \left\lceil \frac{\text{总人数}}{\text{星座数}} \right\rceil$
代入数值：
$$\left\lceil \frac{37}{12} \right\rceil = \left\lceil 3.083 \right\rceil = 4$$


如果换成$38/12=3…2$，答案应该是$3$个。


例2：记T为一队列，初始时为空，现有n个总和不超过32的正整数依次入队列。如果无论这些数具体为何值，都能找到一种出队的方式，使得存在某个时刻队列T中的数之和恰好为9，那么n的最小值是______。


## 杨辉三角 2★
