# C++输入输出（I/O）
C++ 标准库提供了一组丰富的输入/输出功能，我们将在后续的章节进行介绍。本章将讨论 C++ 编程中最基本和最常见的 I/O 操作。

C++ 的 I/O 发生在流中，流是字节序列。如果字节流是从设备（如键盘、磁盘驱动器、网络连接等）流向内存，这叫做输入操作。如果字节流是从内存流向设备（如显示屏、打印机、磁盘驱动器、网络连接等），这叫做输出操作。

## I/O 库头文件

下列的头文件在 C++ 编程中很重要。

| 头文件 | 函数和描述 |
| --- | --- |
| `<iostream>` | 该文件定义了 **cin、cout、cerr** 和 **clog** 对象，分别对应于标准输入流、标准输出流、非缓冲标准错误流和缓冲标准错误流。 |
| `<iomanip>` | 该文件通过所谓的参数化的流操纵器（比如 **setw** 和 **setprecision** ），来声明对执行标准化 I/O 有用的服务。 |
| `<fstream>` | 该文件为用户控制的文件处理声明服务。我们将在文件和流的相关章节讨论它的细节。 |

## 标准输出流（cout）

预定义的对象 **cout** 是 **iostream** 类的一个实例。cout 对象"连接"到标准输出设备，通常是显示屏。 **cout** 是与流插入运算符 << 结合使用的，如下所示：

[复制代码](https://www.nowcoder.com/tutorial/10003/#)

```java
#include <iostream>
 
using namespace std;
 
intmain( )
{
   charstr[] = "Hello C++";
 
   cout << "Value of str is : "<< str << endl;
}
```

当上面的代码被编译和执行时，它会产生下列结果：
```java
Value of str is : Hello C++
```

C++ 编译器根据要输出变量的数据类型，选择合适的流插入运算符来显示值。<< 运算符被重载来输出内置类型（整型、浮点型、double 型、字符串和指针）的数据项。

流插入运算符 << 在一个语句中可以多次使用，如上面实例中所示， **endl** 用于在行末添加一个换行符。

## 标准输入流（cin）

预定义的对象 **cin** 是 **iostream** 类的一个实例。cin 对象附属到标准输入设备，通常是键盘。 **cin** 是与流提取运算符 >> 结合使用的，如下所示：
```java
#include <iostream>
 
using namespace std;
 
intmain( )
{
   charname[50];
 
   cout << "请输入您的名称： ";
   cin >> name;
   cout << "您的名称是： "<< name << endl;
 
}
```

当上面的代码被编译和执行时，它会提示用户输入名称。当用户输入一个值，并按回车键，就会看到下列结果：

[复制代码](https://www.nowcoder.com/tutorial/10003/#)


# 文件读写（文件流）
C++的输入输出以流（stream）为基础。我们已经学会使用了 `iostream`标准库，它提供了 `cin` 和 `cout` 方法分别用于从标准输入读取流和向标准输出写入流。
### 文件流
C++文件读写（文件I/O）也是基于流的操作。从文件读取流和向文件写入流需要用到 C++ 中另一个标准库`<fstream>`。
它定义了三个新的数据类型：

| 数据类型     | 描述                                                                           |
| -------- | ---------------------------------------------------------------------------- |
| ofstream | 该数据类型表示输出文件流，用于==创建文件并向文件写入信息。==                                             |
| ifstream | 该数据类型表示输入文件流，用于==从文件读取信息==。                                                  |
| fstream  | 该数据类型通常表示文件流，且==同时具有 ofstream 和 ifstream 两种功能==，这意味着它可以创建文件，向文件写入信息，从文件读取信息。 |
通常为了区分读取和写入两种操作，避免出现文件读取写入的冲突，习惯性不使用fstream类型的文件流来处理文件。需要读取时使用ifstream类型，写入时使用ofstream。

使用文件流操作，需要引入如下头文件：
```cpp
#include<iostream>
#include<fstream>
```

### 打开文件
要想读取文件或者写入文件，必须要先打开文件。创建**ofstream** 和 **fstream** 对象都可以用来打开文件进行写操作，如果只需要打开文件进行读操作，则使用 **ifstream** 对象。

打开文件需要用到open()函数，open() 函数是 fstream、ifstream 和 ofstream 类型的一个成员，也就是说，创建上面的三种文件流对象都可以使用open()函数。
open() 函数的标准语法：
```cpp
void open(const char *filename, ios::openmode mode);
```
open函数有两个参数，
- filename：指定要打开的文件地址和名称
- mode：指定文件被打开的模式。

常见模式如下：

| 模式标志       | 描述                                             |
| ---------- | ---------------------------------------------- |
| ios::app   | 追加（append）模式。所有写入都==追加到文件末尾==。                 |
| ios::ate   | 文件打开后定位到文件末尾（at the end）。                      |
| ios::in    | 打开文件用于读取（input）。                               |
| ios::out   | 打开文件用于写入（output）。                              |
| ios::trunc | 如果该文件已经存在，其内容将在打开文件之前被截断（truncate），即把文件长度设为 0。 |
mode参数可以缺省不写，根据不同类型，调用open()函数打开文件时，mode的默认值也不同

| 文件流类型      | 缺省 mode 值           | 说明                 |
| ---------- | ------------------- | ------------------ |
| `ifstream` | `ios::in`           | 文件输入流不支持`ios::out` |
| `ofstream` | `ios::out`          | 文件输出流不支持`ios::in`  |
| `fstream`  | ios::out \| ios::in | 均支持                |



使用方法
```cpp
fstream  afile;
afile.open("file.dat", ios::out | ios::in );
```


### 关闭文件
当处理文件完毕后，要使用`close()`函数关闭打开的文件。

下面是` close() `函数的标准语法。
```cpp
void close();
```
`close()`函数是 fstream、ifstream 和 ofstream 文件流类型的一个成员。也就是说，创建上面的三种文件流对象都可以使用`close()`函数。


> 当 C++ 程序终止时，它会自动关闭刷新所有流，释放所有分配的内存，并关闭所有打开的文件。但程序员应该养成一个好习惯，在程序终止前关闭所有打开的文件。

### 写入文件
和使用`cout`输出流时一样把信息打印到屏幕上一样，向文件写入信息时通过流插入运算符（ `<<`）向文件写入信息。
唯一不同的是，这里使用的是 `ofstream` 或 `fstream` 对象，而不是 `cout` 对象。

### 读取文件
和使用`cin`输入流从键盘输入信息一样，读取文件时使用流提取运算符（`>>` ）从文件读取信息。
唯一不同的是，这里使用的是 `ifstream` 或 `fstream` 对象，而不是 `cin` 对象。

##### 按字符串读取
流读取运算符`>>`每次读取按空格/换行符分隔的一个字符串。
例如：
```cpp
#include <fstream>
#include <iostream>
using namespace std;
 
int main() {
    
   char data[100];
 
   // 以写模式打开文件
   ofstream outfile;
   outfile.open("afile.dat");
 
   cout << "Writing to the file" << endl;
   cout << "Enter your name: "; 
   cin.getline(data, 100);
 
   // 向文件写入用户输入的数据
   outfile << data << endl;
 
   cout << "Enter your age: "; 
   cin >> data;
   cin.ignore();
   
   // 再次向文件写入用户输入的数据
   outfile << data << endl;
 
   // 关闭打开的文件
   outfile.close();
 
   // 以读模式打开文件
   ifstream infile; 
   infile.open("afile.dat"); 
 
   cout << "Reading from the file" << endl;
 
   // 循环读取文件中的所有数据
   while (infile >> data) {
       // 在屏幕上写入数据
       cout << data << endl;
   }
 
   // 关闭打开的文件
   infile.close();
 
   return 0;
}

```

##### 按行读取
另一种读取文件的方法，是使用输出流的getline()成员函数。
`getline()`函数一次读取文件的一整行，而不是以空格为分隔符读取文件数据。
getline()函数参数有两个：
- 第一个参数是用于存储读取得到数据的变量
- 第二个参数是读取一行的长度
```cpp
#include <fstream>
#include <iostream>
using namespace std;
 
int main() {
    
   char data[100];
 
   // 以写模式打开文件
   ofstream outfile;
   outfile.open("afile.dat");
 
   cout << "Writing to the file" << endl;
   cout << "Enter your name: "; 
   cin.getline(data, 100);
 
   // 向文件写入用户输入的数据
   outfile << data << endl;
 
   cout << "Enter your age: "; 
   cin >> data;
   cin.ignore();
   
   // 再次向文件写入用户输入的数据
   outfile << data << endl;
 
   // 关闭打开的文件
   outfile.close();
 
   // 以读模式打开文件
   ifstream infile; 
   infile.open("afile.dat"); 
 
   cout << "Reading from the file" << endl;
 
   // 循环读取文件中的所有行
   while (infile.getline(data, 100)) {
       // 在屏幕上写入数据
       cout << data << endl;
   }
 
   // 关闭打开的文件
   infile.close();
 
   return 0;
}
```

